!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).swivel=e()}}(function(){return function i(u,a,c){function s(t,e){if(!a[t]){if(!u[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(l)return l(t,!0);var r=new Error("Cannot find module '"+t+"'");throw r.code="MODULE_NOT_FOUND",r}var o=a[t]={exports:{}};u[t][0].call(o.exports,function(e){return s(u[t][1][e]||e)},o,o.exports,i,u,a,c)}return a[t].exports}for(var l="function"==typeof require&&require,e=0;e<c.length;e++)s(c[e]);return s}({1:[function(e,t,n){t.exports=function(e,t){return Array.prototype.slice.call(e,t)}},{}],2:[function(e,t,n){"use strict";var r=e("ticky");t.exports=function(e,t,n){e&&r(function(){e.apply(n||null,t||[])})}},{ticky:5}],3:[function(e,t,n){"use strict";var a=e("atoa"),c=e("./debounce");t.exports=function(o,e){var i=e||{},u={};return void 0===o&&(o={}),o.on=function(e,t){return u[e]?u[e].push(t):u[e]=[t],o},o.once=function(e,t){return t._once=!0,o.on(e,t),o},o.off=function(e,t){var n=arguments.length;if(1===n)delete u[e];else if(0===n)u={};else{var r=u[e];if(!r)return o;r.splice(r.indexOf(t),1)}return o},o.emit=function(){var e=a(arguments);return o.emitterSnapshot(e.shift()).apply(this,e)},o.emitterSnapshot=function(r){var e=(u[r]||[]).slice(0);return function(){var t=a(arguments),n=this||o;if("error"===r&&!1!==i.throws&&!e.length)throw 1===t.length?t[0]:t;return e.forEach(function(e){i.async?c(e,t,n):e.apply(n,t),e._once&&o.off(r,e)}),o}},o}},{"./debounce":2,atoa:1}],4:[function(e,t,n){var r,o,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(e){r=u}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}}();var s,l=[],f=!1,p=-1;function d(){f&&s&&(f=!1,s.length?l=s.concat(l):p=-1,l.length&&m())}function m(){if(!f){var e=c(d);f=!0;for(var t=l.length;t;){for(s=l,l=[];++p<t;)s&&s[p].run();p=-1,t=l.length}s=null,f=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new v(e,t)),1!==l.length||f||c(m)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],5:[function(e,n,t){(function(t){var e;e="function"==typeof t?function(e){t(e)}:function(e){setTimeout(e,0)},n.exports=e}).call(this,e("timers").setImmediate)},{timers:6}],6:[function(c,e,s){(function(e,t){var r=c("process/browser.js").nextTick,n=Function.prototype.apply,o=Array.prototype.slice,i={},u=0;function a(e,t){this._id=e,this._clearFn=t}s.setTimeout=function(){return new a(n.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new a(n.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(e){e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},s.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},s._unrefActive=s.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;0<=t&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},s.setImmediate="function"==typeof e?e:function(e){var t=u++,n=!(arguments.length<2)&&o.call(arguments,1);return i[t]=!0,r(function(){i[t]&&(n?e.apply(null,n):e.call(null),s.clearImmediate(t))}),t},s.clearImmediate="function"==typeof t?t:function(e){delete i[e]}}).call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":4,timers:6}],7:[function(e,t,n){"use strict";var u=e("atoa"),a=e("./serialization"),c=e("contra/emitter");t.exports=function(){return function e(n){var r=c();var t={on:i("on"),once:i("once"),off:i("off"),emit:function(){if(!n)return Promise.reject(new Error("ServiceWorker not found."));var e=a.parsePayload(u(arguments)),t=new MessageChannel;return t.port1.addEventListener("message",o),t.port1.start(),n.postMessage(e,[t.port2])},at:e};var o=a.emission(r,{broadcast:!1});navigator.serviceWorker.addEventListener("controllerchange",function(){n=navigator.serviceWorker.controller});navigator.serviceWorker.addEventListener("message",function(e){if(e.source!==n)return;var t=e.data;t&&t.__broadcast&&a.emission(r,{broadcast:!0})(e)});return t;function i(e){return function(){return r[e].apply(null,arguments),t}}}(navigator.serviceWorker.controller)}},{"./serialization":8,atoa:1,"contra/emitter":3}],8:[function(e,t,n){"use strict";t.exports={parsePayload:function(e){var t,n=e.shift();return"error"===n?{error:(t=e[0],t?t.toString():null),type:n,payload:[]}:{error:null,type:n,payload:e}},emission:function(r,o){return function(e){var t,n=e.data;"error"===n.type?r.emit.call(null,"error",o,(t=n.error)?new Error(t):null):r.emit.apply(null,[n.type,o].concat(n.payload))}}}},{}],9:[function(e,t,n){"use strict";var r,o=e("./page"),i=e("./worker");function u(){throw new Error("Swivel couldn't detect ServiceWorker support. Please feature detect before using Swivel in your web pages!")}r="undefined"!=typeof navigator&&"serviceWorker"in navigator?o():"undefined"!=typeof self&&"clients"in self?i():{on:u,once:u,off:u,emit:u,broadcast:u},t.exports=r},{"./page":7,"./worker":10}],10:[function(e,t,n){"use strict";var i=e("atoa"),u=e("./serialization"),a=e("contra/emitter");t.exports=function(){var r=a(),t={on:e("on"),once:e("once"),off:e("off"),broadcast:function(t){var n=i(arguments,1);return self.clients.matchAll().then(function(e){return e.map(r)});function r(e){return e.postMessage({type:t,payload:n,__broadcast:!0})}},emit:function(e){var t=i(arguments);return self.clients.matchAll().then((n=e,function(e){for(var t=0;t<e.length;t++)if(e[t].id===n)return e[t];return null})).then(function(e){t[0]=e,o.apply(this,t)});var n}};return self.addEventListener("message",function(e){var t,n={reply:(t=e,o.bind(null,t.ports[0]))};u.emission(r,n)(e)}),t;function e(e){return function(){return r[e].apply(null,arguments),t}}function o(e){var t=u.parsePayload(i(arguments,1));return e.postMessage(t)}}},{"./serialization":8,atoa:1,"contra/emitter":3}]},{},[9])(9)});